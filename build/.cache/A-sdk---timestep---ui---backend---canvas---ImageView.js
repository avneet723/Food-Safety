a0e24439726dad13fa63acfad6279e13
jsio("import util.path");jsio("import std.uri as URI");jsio("import ui.View as View");jsio("import ui.resource.Image as Image");
var sdk_timestep_ui_backend_canvas_ImageView=__class__,ImageView=exports=sdk_timestep_ui_backend_canvas_ImageView(function(){return this.init&&this.init.apply(this,arguments)},View,function(d){this.init=function(a){d(this,"init",arguments);a=merge(a,{image:null,autoSize:!1});a.image&&this.setImage(a.image,a)};this.getImage=function(){return this._img};this._imgCache={};this.setImage=function(a,b){if("string"==typeof a){var c=a;(a=this._imgCache[c])||(this._imgCache[a]=a=new Image({url:c}))}if(this._img=
a)b&&b.autoSize&&(0<this._img.getWidth()&&0<this._img.getHeight()?this.autoSize():this._img.doOnLoad(this,"autoSize")),this._img.doOnLoad(this,"needsRepaint")};this.doOnLoad=function(){1==arguments.length?this._img.doOnLoad(this,arguments[0]):this._img.doOnLoad.apply(this._img,arguments);return this};this.autoSize=function(){this._img&&(this.style.width=this._img.getWidth(),this.style.height=this._img.getHeight(),this.style.fixedAspectRatio&&this.style.updateAspectRatio())};this.getOrigWidth=this.getOrigW=
function(){return this._img.getOrigW()};this.getOrigHeight=this.getOrigH=function(){return this._img.getOrigH()};this.render=function(a){if(this._img){var b=this.style;this._img.render(a,0,0,b.width,b.height)}};var e=window.location.toString(),f=window.location.hostname;this.getTag=function(){var a;if(this._img){var b=this._img.getOriginalURL();if(this._cachedTag&&b==this._cachedTag.url)a=this._cachedTag.tag;else{a=URI.relativeTo(b,e);var c=a.getHost();a=util.path.splitExt(a.getFile()).basename+(c&&
c!=f?":"+c:"");this._cachedTag={url:b,tag:a}}}return(a||"")+":ImageView"+this.uid}});
