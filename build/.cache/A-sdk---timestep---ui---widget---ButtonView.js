a2afbf7322a60e00349a27e3d2f5236e
jsio("import ui.View as View");jsio("import ui.ImageView as ImageView");jsio("import ui.ImageScaleView as ImageScaleView");jsio("import ui.TextView as TextView");jsio("import AudioManager");jsio("import lib.Enum as Enum");
var states=Enum("UP","DOWN","DISABLED","SELECTED","UNSELECTED"),lastClicked=null,sdk_timestep_ui_widget_ButtonView=__class__,ButtonView=exports=sdk_timestep_ui_widget_ButtonView(function(){return this.init&&this.init.apply(this,arguments)},ImageScaleView,function(e){var d=!1;this.init=function(a){this._state=a.defaultState||a.state||states.UP;e(this,"init",arguments);var b=merge(a.text,{superview:this,text:a.title||"",x:0,y:0,canHandleEvents:!1});this._text=new TextView(b);b=merge(a.icon,{superview:this,
x:0,y:0,canHandleEvents:!1});this._icon=new ImageView(b);this.updateOpts(a);this._trigger(this._state,!0)};this.updateOpts=function(a){a=merge(a,this._opts);this._opts=a=e(this,"updateOpts",[a]);this._images=a.images;this._onHandlers=a.on||{};this._audioManager=a.audioManager;this._sounds=a.sounds;"text"in a&&this._text&&this._text.updateOpts(a.text)};this.onInputStart=function(){this._state!==states.DISABLED&&(lastClicked=this.uid,this._state=states.DOWN,this._trigger(states.DOWN))};this.onInputOver=
function(){this._state===states.DISABLED||lastClicked!=this.uid||(this._state=states.DOWN,this._trigger(states.DOWN,!0))};this.onInputSelect=function(){this._state!==states.DISABLED&&(this._opts.onClick&&this._opts.onClick.call(this),this.onClick&&this.onClick(),this._opts.clickOnce?(this._state=states.DISABLED,this._trigger(states.UP),this._trigger(states.DISABLED)):this._opts.toggleSelected?d?(this._trigger(states.UNSELECTED),d=!1):(this._trigger(states.SELECTED),d=!0):this._trigger(states.UP))};
this.onInputOut=function(){this._state!==states.DISABLED&&this._state!==states.UP&&(this._state=states.UP,this._trigger(states.UP,!0))};this._trigger=function(a,b){var c=states[a];c&&(c=c.toLowerCase(),this._images&&this._images[c]&&this.setImage(this._images[c]),b||("function"===typeof this._onHandlers[c]&&this._onHandlers[c].call(this),this._sounds&&this._sounds[c]&&this._audioManager&&this._audioManager.play(this._sounds[c]),this.emit(c)))};this.reflow=function(){this._text.style.width=this.style.width;
this._text.style.height=this.style.height};this.getText=function(){return this._text};this.setTitle=function(a){this._text.setText(a)};this.getIcon=function(){return this._icon};this.setIcon=function(a){this._icon.setImage(a)};this.setState=function(a){var b=states[a];b&&(this._state=a,b=b.toLowerCase(),this.setImage(this._images[b]))}});ButtonView.states=states;
