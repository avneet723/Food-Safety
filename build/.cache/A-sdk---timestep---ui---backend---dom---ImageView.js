639e7dd23dcdac21263970364465f96b
jsio("import ui.View as View");jsio("import ui.resource.Image as Image");function getImageURL(c){return c.getSource?c.getSource().src:c}var sdk_timestep_ui_backend_dom_ImageView=__class__;
exports=sdk_timestep_ui_backend_dom_ImageView(function(){return this.init&&this.init.apply(this,arguments)},View,function(c){this.init=function(a){a=merge(a,{image:null,autoSize:!1});c(this,"init",[a]);a.image&&this.setImage(a.image,a)};this.autoSize=function(){this._img&&(this.style.width=this._img.getWidth(),this.style.height=this._img.getHeight(),this.style.fixedAspectRatio&&this.style.updateAspectRatio())};this.tick=function(){if(this._img){var a=JSON.stringify(this._img.getBounds());this._cachedBounds!=
a&&(this._cachedBounds=a,this.updateImage())}};this._imgCache={};this.getImage=function(){return this._img};this.setImage=function(a,d){if("string"==typeof a){var b=a;(a=this._imgCache[b])||(this._imgCache[a]=a=new Image({url:b}))}(this._img=a)?(d&&d.autoSize&&(0<this._img.getWidth()&&0<this._img.getHeight()?this.autoSize():this._img.doOnLoad(this,"autoSize")),this._img.doOnLoad(this,"updateImage")):this.updateImage()};this.reflow=function(){this.updateImage()};this.updateImage=function(){var a=this.__view._node.style;
if(!this._img||!this._img.isReady())a.backgroundImage="none";else{var d=this._img,b=d.getBounds(),c=d.getOrigW(),g=d.getOrigH(),e=b.width+b.marginLeft+b.marginRight,f=b.height+b.marginTop+b.marginBottom;a.padding=b.marginTop+"px "+b.marginRight+"px "+b.marginBottom+"px "+b.marginLeft+"px";e=this.style.width/e;f=this.style.height/f;a.webkitBackgroundClip=a.backgroundClip="content-box";a.backgroundImage='url("'+getImageURL(d)+'")';a.backgroundPositionX=e*(-b.x+b.marginLeft)+"px";a.backgroundPositionY=
f*(-b.y+b.marginTop)+"px";a.backgroundSize=c*e+"px "+g*f+"px"}};this.getOrigWidth=this.getOrigW=function(){return this._img.getOrigW()};this.getOrigHeight=this.getOrigH=function(){return this._img.getOrigH()};this.doOnLoad=function(){1==arguments.length?this._img.doOnLoad(this,arguments[0]):this._img.doOnLoad.apply(this._img,arguments);return this}});
